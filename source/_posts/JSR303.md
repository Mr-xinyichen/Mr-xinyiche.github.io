---
layout: posts
title: JSR303
date: 2020-03-16 19:35:00
updated: 2020-03-16 19:39:28
tags: 
categories: 
 - 经验&bug
---
## SpringMVC支持使用 【JSR303】 方式进行校验
## springboot默认导第三方的校验框架hibernate-validator

## 使用JSR303的三大步：
 * ## 1、给需要校验数据的javaBean上标注校验注解： 
 能使用的校验注解:
      * 1)、Hibernate   org.hibernate.validator.constraints 里面的所有 
 	  * 2)、JSR303规范规定的都可；javax.validation.constraints
      * 3)、正则表达式 @Pattern(regexp = "") 
	
    
	```java
	    @Length(min = 4,max = 8,message = "用户名长度必须4-8位")
	    private String username;
	   
	    @NotEmpty
	    private String password;
	
		@Null  //必须为空
	    private String nickName;
		
		@Pattern(regexp = "")//正则
	    private String note;
  ```
  
 * ## 2、告诉SpringBoot，这个需要校验；@Valid
 * 
	       springmvc进入方法之前，确定参数值的时候就会进行校验，如果校验出错，直接返回错误，不执行controller代码
       
 * ## 3、如何感知校验成功还是失败；
	
   * 1）.只给开启了校验的javaBean参数后面，紧跟一个BindingResult对象,就可以获取到校验结果;
   * 2).只要有BindingResult，即使**校验错了方法也会执行**。我们需要手动处理

 	


```java
public Object register(@Valid @RequestBody UmsAdminParam umsAdminParam, BindingResult result) {
    int errorCount = result.getErrorCount();
    if(errorCount>0){  //校验失败
        List<FieldError> fieldErrors = result.getFieldErrors();
        fieldErrors.forEach((fieldError)->{
            String field = fieldError.getField();
            log.debug("出错的属性：{}，传来的值是：{}，校验出错。出错的提示消息：{}",
                    field,fieldError.getRejectedValue(),fieldError.getDefaultMessage());
        });
        return new CommonResult().validateFailed(result);
    }else {
        //TODO 完成注册功能
    }
    log.debug("需要注册的用户详情：{}",umsAdminParam);
    return new CommonResult().success("");
}		     
```